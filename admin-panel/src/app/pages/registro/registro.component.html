<mat-card>
  <mat-card-header>
    <mat-card-title>Registrar Usuario</mat-card-title>
    <mat-card-subtitle>Complete el formulario con validación. El botón Guardar solo se habilita cuando todos los campos son válidos.</mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>
    <form [formGroup]="formulario" (ngSubmit)="guardar()">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nombre completo</mat-label>
        <input matInput formControlName="nombre" placeholder="Ej. Juan Pérez">
        <mat-icon matPrefix>person</mat-icon>
        @if (formulario.get('nombre')?.invalid && formulario.get('nombre')?.touched) {
          <mat-error>El nombre es requerido y debe tener al menos 2 caracteres.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Correo electrónico</mat-label>
        <input matInput type="email" formControlName="email" placeholder="ejemplo@correo.com">
        <mat-icon matPrefix>email</mat-icon>
        @if (formulario.get('email')?.invalid && formulario.get('email')?.touched) {
          <mat-error>Introduzca un email válido.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Rol</mat-label>
        <mat-select formControlName="rol" placeholder="Seleccione un rol">
          @for (r of roles; track r.value) {
            <mat-option [value]="r.value">{{ r.label }}</mat-option>
          }
        </mat-select>
        <mat-icon matPrefix>badge</mat-icon>
        @if (formulario.get('rol')?.invalid && formulario.get('rol')?.touched) {
          <mat-error>Seleccione un rol.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Fecha de nacimiento</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="fechaNacimiento" placeholder="Elegir fecha">
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        @if (formulario.get('fechaNacimiento')?.invalid && formulario.get('fechaNacimiento')?.touched) {
          <mat-error>La fecha de nacimiento es requerida.</mat-error>
        }
      </mat-form-field>

      <div class="actions">
        <button mat-raised-button color="primary" type="submit" [disabled]="formulario.invalid">
          Guardar
        </button>
        <button mat-button type="button" (click)="formulario.reset()">Limpiar</button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
